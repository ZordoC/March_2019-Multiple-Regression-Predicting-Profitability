library(caret)
library(readr)
library(rstudioapi)
library(e1071)
library(dplyr)




current_path = getActiveDocumentContext()$path
setwd(dirname(current_path))
setwd("..")
rm(current_path)
#rm(list = setdiff(ls(), lsf.str()))
EP <- read.csv( file ="./data/Epa.csv" , header = TRUE , sep = ',')
NP <- read.csv(file = "./data/Npa.csv", header = TRUE , sep =',')
EP <- EP[,c(1,5,9,18)]



Knn <- EP %>% mutate_at(scale, .vars = vars(-1))


Knn <- PPfunction(Knn)

EP <- PPfunction(EP)



Knn <- RmOut(Knn)

EP <- RmOut(EP)

List <- TrainAndTestSets(EP$Volume,0.75,EP,233)

ListK <- TrainAndTestSets(Knn$Volume,0.75,Knn,233)


ModelRandomForest <- TrainingFunction(Volume ~.,List$trainingSet,"rf",5)

ModelRandomForest

KNN <- TrainingFunction(Volume ~.,ListK$trainingSet,"knn",5)

PredictionRandomForest <- predict(ModelRandomForest,List$testingSet)

 postResample(PredictionRandomForest,List$testingSet$Volume)

KnnPrediction <- predict(KNN,ListK$testingSet)

postResample(KnnPrediction,ListK$testingSet$Volume)










                         